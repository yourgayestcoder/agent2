<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Signup Supabase</title>
</head>
<body>

<h2>Créer un compte</h2>
<input type="email" id="email" placeholder="Email">
<input type="password" id="password" placeholder="Mot de passe">
<button id="signupBtn">S'inscrire</button>
<div id="result"></div>

<!-- Charger Supabase JS avec onload -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"
        onload="initSupabase()"></script>

<script>
function initSupabase() {
  // Initialisation du client
  window.supabase = supabase.createClient(
    "https://qjmqmcwoprhzzevpiytx.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFqbXFtY3dvcHJoenpldnBpeXR4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyNjk0ODksImV4cCI6MjA3Nzg0NTQ4OX0.fx7-ije0ghFr5fZoeFB6DtQBxcYov1jbvshRQ5TtiQY"
  );

  // Fonction pour créer un compte
  async function testSignup() {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    if (!email || !password) {
      alert("Merci de remplir email et mot de passe");
      return;
    }

    try {
      const { data, error } = await window.supabase.auth.signUp({ email, password });
      const resultDiv = document.getElementById("result");

      if (error) {
        console.error(error);
        resultDiv.innerText = "Erreur : " + error.message;
      } else {
        console.log(data);
        resultDiv.innerText = "Compte créé avec succès ! Vérifiez vos mails pour confirmation si nécessaire.";
      }
    } catch (err) {
      console.error("Erreur signup :", err);
    }
  }

  // Bouton
  document.getElementById("signupBtn").addEventListener("click", testSignup);
}
</script>

</body>
</html>
